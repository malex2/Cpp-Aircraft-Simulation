//  Created by Alexander McLean on 08/09/19.//  Copyright Â© 2019 Alexander McLean. All rights reserved.#include <iostream>#include <chrono>#include <math.h>#include <fstream>#include <algorithm>#include "utilities.hpp"#include "initial_conditions.hpp"#include "model_mapping.hpp"#include "data_logger.hpp"#include "time.hpp"#include "rotate_frame.hpp"#include "ground_model.hpp"#include "dynamics_model.hpp"#include "atmosphere_model.hpp"#include "propulsion_model.hpp"#include "aero_model.hpp"int main() {    // Setup and initialize models    Utilities util;    ModelMap map(false);        DataLogger    dataLog(&map, false, savefile);    Time          time(&map);    RotateFrame   rotate(&map);    SimpleRCAeroModel aeroModel(&map);    PropulsionModel propulsionModel(&map, false);    AtmosphereModel atmosphereModel(&map, false);    GroundModel     groundModel(&map, false);    DynamicsModel   dynamicsModel(&map, false);        map.addModel("Time", &time);    map.addModel("RotateFrame", &rotate);    map.addModel("AeroModel", &aeroModel, forceModel);    map.addModel("PropulsionModel", &propulsionModel, forceModel);    map.addModel("AtmosphereModel", &atmosphereModel, forceModel);    map.addModel("GroundModel", &groundModel, forceModel);    map.addModel("DynamicsModel", &dynamicsModel ,forceModel);        // Prep loop    const int nModels = 7;    bool continueSim[nModels];    std::fill_n(continueSim, nModels, true);        int  simLoopCount   = 0;        rotate.initialize();         // Must be first    dynamicsModel.initialize();  // Must be second    aeroModel.initialize();    propulsionModel.initialize();    atmosphereModel.initialize();    groundModel.initialize();        while( util.all(continueSim, nModels) )    {        // Set rotations        if ( time.performDynamics() )        {            continueSim[0] = rotate.update(); // Update rotation matrices and quaternions                    // Update GNC            //continueSim = main_flightsoftware();                    // Update forces            continueSim[1] = atmosphereModel.update(); // Compute gravity body forces            continueSim[2] = propulsionModel.update(); // Compute propulsion forces            continueSim[3] = aeroModel.update();       // Compute aero body forces            continueSim[4] = groundModel.update();     // Compute ground body forces                        // Update dynamics            continueSim[5] = dynamicsModel.update(); // Compute body velocity and agular velocity from forces and moments        }                if ( time.performPrint() && printOutput ) { dataLog.printLog(); }        if (time.performSave() && saveOutput)     { dataLog.saveLog(); }                // Update time        continueSim[6] = time.update();                simLoopCount++;    }        return 0;}